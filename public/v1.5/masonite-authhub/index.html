<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title> - Hugo Whisper Theme</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="/favicon.png">

  
  
  <link rel="stylesheet" href="/css/style.min.aad43d4ecb69a264f2539b89d7f779d5f3cdff22e7585fe5fc3c77272f1c2696.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-docs">
      <a href="/docs/">
        <span>Docs</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="/"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-docs">
      <a href="/docs/">
        <span>Docs</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            



<div class="docs-menu">
  <div class="form-input-group mb-3 pr-3">
    <label>Version</label>
    <div class="custom_select">
      <select onchange="this.options[this.selectedIndex].value && (window.location = this.options[this.selectedIndex].value);">
        
          
            <option value="/docs/">docs</option>
          
        
          
            <option value="/v1.5/" selected>v1.5</option>
          
        
      </select>
    </div>
  </div>
  <ul class="toc">
    
    <h1 id="table-of-contents">Table of contents</h1>
<ul>
<li><a href="README.md">Introduction</a></li>
</ul>
<h2 id="prologue">Prologue</h2>
<ul>
<li><a href="prologue/introduction-and-installaton.md">Introduction and Installaton</a></li>
<li><a href="prologue/contributing-guide.md">Contributing Guide</a></li>
<li><a href="prologue/how-to-contribute.md">How To Contribute</a></li>
<li><a href="prologue/release-cycle.md">Release Cycle</a></li>
</ul>
<h2 id="whats-new">What&rsquo;s New</h2>
<ul>
<li><a href="whats-new/masonite-1.3.md">Masonite 1.3</a></li>
<li><a href="whats-new/masonite-1.4.md">Masonite 1.4</a></li>
<li><a href="whats-new/masonite-1.5.md">Masonite 1.5</a></li>
</ul>
<h2 id="upgrade-guide">Upgrade Guide</h2>
<ul>
<li><a href="upgrade-guide/masonite-1.3-to-1.4.md">Masonite 1.3 to 1.4</a></li>
<li><a href="upgrade-guide/masonite-1.4-to-1.5.md">Masonite 1.4 to 1.5</a></li>
</ul>
<h2 id="the-basics">The Basics</h2>
<ul>
<li><a href="the-basics/routing.md">Routing</a></li>
<li><a href="the-basics/controllers.md">Controllers</a></li>
<li><a href="the-basics/views.md">Views</a></li>
<li><a href="the-basics/requests.md">Requests</a></li>
<li><a href="the-basics/static-files.md">Static Files</a></li>
<li><a href="the-basics/helper-functions.md">Helper Functions</a></li>
</ul>
<h2 id="the-craft-command">The Craft Command</h2>
<ul>
<li><a href="the-craft-command/introduction.md">Introduction</a></li>
<li><a href="the-craft-command/creating-commands.md">Creating Commands</a></li>
<li><a href="the-craft-command/authentication-system.md">Authentication System</a></li>
</ul>
<h2 id="architectural-concepts">Architectural Concepts</h2>
<ul>
<li><a href="architectural-concepts/request-lifecycle.md">Request Lifecycle</a></li>
<li><a href="architectural-concepts/service-providers.md">Service Providers</a></li>
<li><a href="architectural-concepts/service-container.md">Service Container</a></li>
</ul>
<h2 id="advanced">Advanced</h2>
<ul>
<li><a href="advanced/middleware.md">Middleware</a></li>
<li><a href="advanced/validation.md">Validation</a></li>
<li><a href="advanced/creating-packages.md">Creating Packages</a></li>
<li><a href="advanced/extending-classes.md">Extending Classes</a></li>
<li><a href="advanced/creating-a-mail-driver.md">Creating a Mail Driver</a></li>
<li><a href="advanced/sessions.md">Sessions</a></li>
</ul>
<h2 id="useful-features">Useful Features</h2>
<ul>
<li><a href="useful-features/template-caching.md">Template Caching</a></li>
<li><a href="useful-features/mail.md">Mail</a></li>
<li><a href="useful-features/uploading.md">Uploading</a></li>
<li><a href="useful-features/view-composers-and-sharing.md">View Composers and Sharing</a></li>
<li><a href="useful-features/caching.md">Caching</a></li>
<li><a href="useful-features/broadcasting.md">Broadcasting</a></li>
<li><a href="useful-features/queues-and-jobs.md">Queues and Jobs</a></li>
<li><a href="useful-features/compiling-assets.md">Compiling Assets</a></li>
</ul>
<h2 id="security">Security</h2>
<ul>
<li><a href="security/authentication.md">Authentication</a></li>
<li><a href="security/encryption.md">Encryption</a></li>
<li><a href="security/csrf-protection.md">CSRF Protection</a></li>
</ul>
<h2 id="orator-orm">Orator ORM</h2>
<ul>
<li><a href="https://orator-orm.com/docs/0.9/basic_usage.html">Basic Usage</a></li>
<li><a href="https://orator-orm.com/docs/0.9/query_builder.html">Query Builder</a></li>
<li><a href="https://orator-orm.com/docs/0.9/orm.html">ORM</a></li>
<li><a href="https://orator-orm.com/docs/0.9/pagination.html">Pagination</a></li>
<li><a href="https://orator-orm.com/docs/0.9/schema_builder.html">Schema Builder</a></li>
<li><a href="orator-orm/database-migrations.md">Database Migrations</a></li>
<li><a href="https://orator-orm.com/docs/0.9/collections.html">Collections</a></li>
</ul>
<h2 id="managers-and-drivers">Managers and Drivers</h2>
<ul>
<li><a href="managers-and-drivers/about-managers.md">About Managers</a></li>
<li><a href="managers-and-drivers/about-drivers.md">About Drivers</a></li>
<li><a href="managers-and-drivers/contracts.md">Contracts</a></li>
</ul>
<h2 id="official-packages">Official Packages</h2>
<ul>
<li><a href="https://masoniteframework.gitbooks.io/masonite-entry/content/">Masonite Entry</a></li>
<li><a href="http://billing.masoniteproject.com">Masonite Billing</a></li>
</ul>
<h2 id="creating-your-first-blog">Creating Your First Blog</h2>
<ul>
<li><a href="creating-your-first-blog/introduction.md">Introduction</a></li>
<li><a href="creating-your-first-blog/part-1-creating-our-first-route.md">Part 1 - Creating Our First Route</a></li>
<li><a href="creating-your-first-blog/part-2-creating-our-first-controller.md">Part 2 - Creating Our First Controller</a></li>
<li><a href="creating-your-first-blog/part-3-designing-our-blog.md">Part 3 - Designing Our Blog</a></li>
<li><a href="creating-your-first-blog/part-4-migrations.md">Part 4 - Migrations</a></li>
<li><a href="creating-your-first-blog/part-5-models.md">Part 5 - Models</a></li>
<li><a href="creating-your-first-blog/part-3-authentication.md">Part 3 - Authentication</a></li>
</ul>
    
  </ul>
</div>


          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title"></h1>
<div class="content ">
  <h1 id="masonite-authhub">Masonite AuthHub</h1>
<h1 id="introduction">Introduction</h1>
<p>Masonite AuthHub brings a centralized and easy to integrate OAuth system to the Masonite Framework. Simply add a few lines of code and the entire OAuth workflow is done for you.</p>
<h3 id="getting-started">Getting Started</h3>
<p>To install Masonite AuthHub just pip install it:</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">$ pip install authhub
</code></pre></div><p>After <code>authhub</code> is installed, we just need to publish it.</p>
<h4 id="adding-the-configuration-file">Adding The Configuration File</h4>
<p>Masonite AuthHub uses the <code>config/services.py</code> configuration file. Conveniently, AuthHub comes with a <code>publish</code> command we can use to create this.</p>
<h4 id="note-virtual-environment">NOTE: Virtual Environment</h4>
<p><strong>If you are in a virtual environment, <strong><code>craft publish</code></strong> will not have access to your virtual environment dependencies. In order to fix this, we can add our site packages to our <strong><code>config/packages.py</code></strong> config file</strong></p>
<p>If you are in a virtual environment then go to your <code>config/packages.py</code> file and add your virtual environments site_packages folder to the <code>SITE_PACKAGES</code> list. Your <code>SITE_PACKAGES</code> list may look something like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">SITE_PACKAGES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;venv/lib/python3.6/site-packages&#39;</span>
<span class="p">]</span>
</code></pre></div><p>This will allow <code>craft publish</code> to find our dependencies installed on our virtual environment. Read the <div>
    <a href="Publishing%20Packages">Publishing Packages</a>
</div> documentation for more information.</p>
<h3 id="publishing">Publishing</h3>
<p>Publish AuthHub by running:</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">$ craft publish authhub
</code></pre></div><p>This will create or append to the <code>config/services.py</code> file. If you&rsquo;ve published a package that has used the <code>config/services.py</code> file before than you may have to take the contents of the <code>AUTH_PROVIDERS</code> dictionary that was created and condense it down into a single dictionary.</p>
<p>After we have published AuthHub we should get a dictionary that looks like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">AUTH_PROVIDERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;github&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;client&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;GITHUB_CLIENT&#39;</span><span class="p">),</span>
        <span class="s1">&#39;secret&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;GITHUB_SECRET&#39;</span><span class="p">),</span>
        <span class="s1">&#39;redirect&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;GITHUB_REDIRECT&#39;</span><span class="p">),</span>
        <span class="s1">&#39;driver&#39;</span><span class="p">:</span> <span class="s1">&#39;authhub.providers.GitHubDriver.GitHubDriver&#39;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>Just add the corresponding environment variables to your <code>.env</code> file:</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">GITHUB_CLIENT=XXX
GITHUB_SECRET=XXX
GITHUB_REDIRECT=http://your-redirect-url/
</code></pre></div><p>The <code>GITHUB_REDIRECT</code> url is the url that users will return to after they authenticate. This is likely to match the return URL in your app on the provider you are using. For GitHub, this is called “Authorization callback URL” in your OAuth App’s settings.</p>
<h3 id="redirecting">Redirecting</h3>
<p>AuthHub uses the same syntax for all providers and contains a method of redirecting to the provider as well as a method of getting the response.</p>
<p>To redirect to the provider so you can authorize the user:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">return</span> <span class="n">AuthHub</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">driver</span><span class="p">(</span><span class="s1">&#39;github&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">redirect</span><span class="p">()</span>
</code></pre></div><p>Notice the <code>.driver()</code> method here. This driver will instantiate the driver specified in your configuration setting in the previous step.</p>
<p>If you need to, you can also specify some scopes:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">return</span> <span class="n">AuthHub</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">driver</span><span class="p">(</span><span class="s1">&#39;github&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">scope</span><span class="p">(</span><span class="s1">&#39;repo&#39;</span><span class="p">,</span> <span class="s1">&#39;public_repo&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">redirect</span><span class="p">()</span>
</code></pre></div><p>Or pass in a state:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">return</span> <span class="n">AuthHub</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">driver</span><span class="p">(</span><span class="s1">&#39;github&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">scope</span><span class="p">(</span><span class="s1">&#39;repo&#39;</span><span class="p">,</span> <span class="s1">&#39;public_repo&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">state</span><span class="p">(</span><span class="s1">&#39;secret_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">redirect</span><span class="p">()</span>
</code></pre></div><p>The state will be a value returned back after the user has authenticated. This is good for verifying if the user that sent the request is the one that received it.</p>
<p>To get the user response back after the user has authenticated:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">return</span> <span class="n">AuthHub</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">driver</span><span class="p">(</span><span class="s1">&#39;github&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">user</span><span class="p">()</span>
</code></pre></div><p>What this method does is:</p>
<ul>
<li>receives the response back from the provider</li>
<li>gets the code from the query string</li>
<li>exchanges the code for an access token</li>
<li>uses the access token to retrieve and return the user.</li>
</ul>
<p>Pretty cool, huh?</p>
<p>A complete setup might look something like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">authhub.authhub</span> <span class="kn">import</span> <span class="n">AuthHub</span>

<span class="k">class</span> <span class="nc">LoginController</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="s1">&#39;&#39;&#39; Class Docstring Description &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">toProvider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AuthHub</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">driver</span><span class="p">(</span><span class="s1">&#39;github&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">redirect</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">fromProvider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">AuthHub</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">driver</span><span class="p">(</span><span class="s1">&#39;github&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">user</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">]</span> <span class="c1"># returns github username</span>
</code></pre></div><p>Thats it! Check your platform’s typically response in order to see what is in the  user object. It’s a good idea to store the access token in your <code>app/User</code> table and use that token to perform API requests on behest of the user. Many providers like GitHub, Facebook and Twitter all have great Python libraries you can use the token with.</p>

</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
