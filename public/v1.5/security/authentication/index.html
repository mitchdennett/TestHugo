<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title> - Hugo Whisper Theme</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="/favicon.png">

  
  
  <link rel="stylesheet" href="/css/style.min.aad43d4ecb69a264f2539b89d7f779d5f3cdff22e7585fe5fc3c77272f1c2696.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-docs">
      <a href="/docs/">
        <span>Docs</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="/"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-docs">
      <a href="/docs/">
        <span>Docs</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            



<div class="docs-menu">
  <div class="form-input-group mb-3 pr-3">
    <label>Version</label>
    <div class="custom_select">
      <select onchange="this.options[this.selectedIndex].value && (window.location = this.options[this.selectedIndex].value);">
        
          
            <option value="/docs/">docs</option>
          
        
          
            <option value="/v1.5/" selected>v1.5</option>
          
        
      </select>
    </div>
  </div>
  <ul class="toc">
    
    <h1 id="table-of-contents">Table of contents</h1>
<ul>
<li><a href="README.md">Introduction</a></li>
</ul>
<h2 id="prologue">Prologue</h2>
<ul>
<li><a href="prologue/introduction-and-installaton.md">Introduction and Installaton</a></li>
<li><a href="prologue/contributing-guide.md">Contributing Guide</a></li>
<li><a href="prologue/how-to-contribute.md">How To Contribute</a></li>
<li><a href="prologue/release-cycle.md">Release Cycle</a></li>
</ul>
<h2 id="whats-new">What&rsquo;s New</h2>
<ul>
<li><a href="whats-new/masonite-1.3.md">Masonite 1.3</a></li>
<li><a href="whats-new/masonite-1.4.md">Masonite 1.4</a></li>
<li><a href="whats-new/masonite-1.5.md">Masonite 1.5</a></li>
</ul>
<h2 id="upgrade-guide">Upgrade Guide</h2>
<ul>
<li><a href="upgrade-guide/masonite-1.3-to-1.4.md">Masonite 1.3 to 1.4</a></li>
<li><a href="upgrade-guide/masonite-1.4-to-1.5.md">Masonite 1.4 to 1.5</a></li>
</ul>
<h2 id="the-basics">The Basics</h2>
<ul>
<li><a href="the-basics/routing.md">Routing</a></li>
<li><a href="the-basics/controllers.md">Controllers</a></li>
<li><a href="the-basics/views.md">Views</a></li>
<li><a href="the-basics/requests.md">Requests</a></li>
<li><a href="the-basics/static-files.md">Static Files</a></li>
<li><a href="the-basics/helper-functions.md">Helper Functions</a></li>
</ul>
<h2 id="the-craft-command">The Craft Command</h2>
<ul>
<li><a href="the-craft-command/introduction.md">Introduction</a></li>
<li><a href="the-craft-command/creating-commands.md">Creating Commands</a></li>
<li><a href="the-craft-command/authentication-system.md">Authentication System</a></li>
</ul>
<h2 id="architectural-concepts">Architectural Concepts</h2>
<ul>
<li><a href="architectural-concepts/request-lifecycle.md">Request Lifecycle</a></li>
<li><a href="architectural-concepts/service-providers.md">Service Providers</a></li>
<li><a href="architectural-concepts/service-container.md">Service Container</a></li>
</ul>
<h2 id="advanced">Advanced</h2>
<ul>
<li><a href="advanced/middleware.md">Middleware</a></li>
<li><a href="advanced/validation.md">Validation</a></li>
<li><a href="advanced/creating-packages.md">Creating Packages</a></li>
<li><a href="advanced/extending-classes.md">Extending Classes</a></li>
<li><a href="advanced/creating-a-mail-driver.md">Creating a Mail Driver</a></li>
<li><a href="advanced/sessions.md">Sessions</a></li>
</ul>
<h2 id="useful-features">Useful Features</h2>
<ul>
<li><a href="useful-features/template-caching.md">Template Caching</a></li>
<li><a href="useful-features/mail.md">Mail</a></li>
<li><a href="useful-features/uploading.md">Uploading</a></li>
<li><a href="useful-features/view-composers-and-sharing.md">View Composers and Sharing</a></li>
<li><a href="useful-features/caching.md">Caching</a></li>
<li><a href="useful-features/broadcasting.md">Broadcasting</a></li>
<li><a href="useful-features/queues-and-jobs.md">Queues and Jobs</a></li>
<li><a href="useful-features/compiling-assets.md">Compiling Assets</a></li>
</ul>
<h2 id="security">Security</h2>
<ul>
<li><a href="security/authentication.md">Authentication</a></li>
<li><a href="security/encryption.md">Encryption</a></li>
<li><a href="security/csrf-protection.md">CSRF Protection</a></li>
</ul>
<h2 id="orator-orm">Orator ORM</h2>
<ul>
<li><a href="https://orator-orm.com/docs/0.9/basic_usage.html">Basic Usage</a></li>
<li><a href="https://orator-orm.com/docs/0.9/query_builder.html">Query Builder</a></li>
<li><a href="https://orator-orm.com/docs/0.9/orm.html">ORM</a></li>
<li><a href="https://orator-orm.com/docs/0.9/pagination.html">Pagination</a></li>
<li><a href="https://orator-orm.com/docs/0.9/schema_builder.html">Schema Builder</a></li>
<li><a href="orator-orm/database-migrations.md">Database Migrations</a></li>
<li><a href="https://orator-orm.com/docs/0.9/collections.html">Collections</a></li>
</ul>
<h2 id="managers-and-drivers">Managers and Drivers</h2>
<ul>
<li><a href="managers-and-drivers/about-managers.md">About Managers</a></li>
<li><a href="managers-and-drivers/about-drivers.md">About Drivers</a></li>
<li><a href="managers-and-drivers/contracts.md">Contracts</a></li>
</ul>
<h2 id="official-packages">Official Packages</h2>
<ul>
<li><a href="https://masoniteframework.gitbooks.io/masonite-entry/content/">Masonite Entry</a></li>
<li><a href="http://billing.masoniteproject.com">Masonite Billing</a></li>
</ul>
<h2 id="creating-your-first-blog">Creating Your First Blog</h2>
<ul>
<li><a href="creating-your-first-blog/introduction.md">Introduction</a></li>
<li><a href="creating-your-first-blog/part-1-creating-our-first-route.md">Part 1 - Creating Our First Route</a></li>
<li><a href="creating-your-first-blog/part-2-creating-our-first-controller.md">Part 2 - Creating Our First Controller</a></li>
<li><a href="creating-your-first-blog/part-3-designing-our-blog.md">Part 3 - Designing Our Blog</a></li>
<li><a href="creating-your-first-blog/part-4-migrations.md">Part 4 - Migrations</a></li>
<li><a href="creating-your-first-blog/part-5-models.md">Part 5 - Models</a></li>
<li><a href="creating-your-first-blog/part-3-authentication.md">Part 3 - Authentication</a></li>
</ul>
    
  </ul>
</div>


          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title"></h1>
<div class="content ">
  <h1 id="authentication">Authentication</h1>
<h2 id="introduction">Introduction</h2>
<p>Masonite comes with some authentication out of the box but leaves it up to the developer to implement. Everything is already configured for you by default. The default authentication model is the <code>app/User</code> model but you can change this in the <code>config/auth.py</code> configuration file.</p>
<h2 id="configuration">Configuration</h2>
<p>There is only a single <code>config/auth.py</code> configuration file which you can use to set the authentication behavior of your Masonite project. If you wish to change the authentication model, to a <code>app/Company</code> model for example, feel free to do in this configuration file.</p>
<h2 id="authentication-model">Authentication Model</h2>
<p>Again the default authentication model is the <code>app/User</code> model which out of the box comes with a <code>__auth__</code> class attribute. This attribute should be set to the column that you want to authenticate with. By default your <code>app/User</code> model will default to the <code>email</code> column but if you wish to change this to another column such as <code>name</code>, you can do so here. This will lead your model to look like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">__fillable__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">]</span>

    <span class="n">__auth__</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span>
</code></pre></div><p>{% hint style=&quot;info&rdquo; %}
<strong>All models that should be authenticated in addition to specifying a</strong> <code>__auth__</code> <strong>attribute also needs to have a</strong> <code>password</code> <strong>field as well in order to use the out of the box authentication that comes with Masonite.</strong>
{% endhint %}</p>
<h2 id="authenticating-a-model">Authenticating a Model</h2>
<p>If you want to authenticate a model, you can use the <code>Auth</code> facade that ships with Masonite. This is simply a class that is used to authenticate models with a <code>.login()</code> method.</p>
<p>In order to authenticate a model this will look like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">masonite.facades.Auth</span> <span class="kn">import</span> <span class="n">Auth</span>

<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Request</span><span class="p">):</span>
    <span class="n">Auth</span><span class="p">(</span><span class="n">Request</span><span class="p">)</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="s1">&#39;user@email.com&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">)</span>
</code></pre></div><p>This will find a model with the supplied username, check if the password matches using <code>bcrypt</code> and return the model. If it is not found or the password does not match, it will return <code>False</code>.</p>
<p>{% hint style=&quot;warning&rdquo; %}
Again all authenticating models need to have a <code>password</code> column. The column being used to authenticate, such as a username or email field can be specified in the model using the <code>__auth__</code> class attribute.
{% endhint %}</p>
<h3 id="changing-the-authentication-model">Changing The Authentication Model</h3>
<p>You may change the column to be authenticated by simply changing the column value of the <code>__auth__</code> class attribute. This will look something like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">__fillable__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">]</span>

    <span class="n">__auth__</span> <span class="o">=</span> <span class="s1">&#39;email&#39;</span>
</code></pre></div><p>This will look inside the <code>email</code> column now and check that column and password. The authentication column is <code>email</code> by default.</p>
<h2 id="creating-an-authentication-system">Creating an Authentication System</h2>
<p>You may of course feel free to roll your own authentication system if you so choose but Masonite comes with one out of the box but left out by default. In order to scaffold this authentication system you can of course use a <code>craft</code> command:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ craft auth
</code></pre></div><p>This will create some controllers, views and routes for you. This command should be used primarily on fresh installs of Masonite but as long as the controllers do not have the same names as the controllers being scaffolded, you will not have any issues.</p>
<p>The views scaffolded will be located under <code>resources/templates/auth</code>.</p>
<p>After you have ran the <code>craft auth</code> command, just run the server and navigate to <code>http://localhost:8000/login</code> and you will now have a login, registration and dashboard. Pretty cool, huh?</p>
<h3 id="retrieving-the-authenticated-user">Retrieving the Authenticated User</h3>
<p>Masonite ships with a <code>LoadUser</code> middleware that will load the user into the request if they are authenticated. Masonite uses the <code>token</code> cookie in order to retrieve the user using the <code>remember_token</code>column in the table.</p>
<p>Using this <code>LoadUser</code> middleware you can retrieve the current user using:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Request</span><span class="p">):</span>
    <span class="n">Request</span><span class="o">.</span><span class="n">user</span><span class="p">()</span>
</code></pre></div><p>If you wish not to use middleware to load the user into the request you can get the request by again using the <code>Auth</code> class</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">masonite.facades.Auth</span> <span class="kn">import</span> <span class="n">Auth</span>

<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Request</span><span class="p">):</span>
    <span class="n">Auth</span><span class="p">(</span><span class="n">Request</span><span class="p">)</span><span class="o">.</span><span class="n">user</span><span class="p">()</span>
</code></pre></div><h3 id="checking-if-the-user-is-authenticated">Checking if the User is Authenticated</h3>
<p>If you would like to simply check if the user is authenticated, <code>Request.user()</code> or <code>Auth(Request).user()</code> will return <code>False</code> if the user is not authenticated. This will look like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">Request</span><span class="o">.</span><span class="n">user</span><span class="p">():</span>
        <span class="n">user_email</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">user</span><span class="p">()</span><span class="o">.</span><span class="n">email</span>
</code></pre></div><h2 id="protecting-routes">Protecting Routes</h2>
<p>Masonite ships with an authentication middleware. You can use this middleware as a route middleware to protect certain routes from non authenticated users. This is great for redirecting users to a login page if they attempt to go to their dashboard.</p>
<p>You can use this middleware in your routes file like so:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">Get</span><span class="p">()</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/dashboard&#39;</span><span class="p">,</span> <span class="s1">&#39;DashboardController@show&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">middleware</span><span class="p">(</span><span class="s1">&#39;auth&#39;</span><span class="p">)</span>
</code></pre></div><p>By default this will redirect to the route named <code>login</code>. If you wish to redirect the user to another route or to a different URI, you can edit the middleware in <code>app/http/middleware/AuthenticationMiddleware.py</code></p>
<h3 id="logging-out-a-user">Logging Out a User</h3>
<p>If you wish to end the session for the user and log them out, you can do so by using the <code>Auth</code> class. This looks like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">Auth</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
</code></pre></div><p>This will delete the cookie that was set when logging in. This will not redirect the user to where they need to go. A complete logout view might look like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">logout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Request</span><span class="p">):</span>
    <span class="n">Auth</span><span class="p">(</span><span class="n">Request</span><span class="p">)</span><span class="o">.</span><span class="n">logout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Request</span><span class="o">.</span><span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">)</span>
</code></pre></div><p>Great! You’ve mastered how Masonite uses authentication. Remember that this is just out of the box functionality and you can create a completely different authentication system but this will suffice for most applications.</p>

</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
