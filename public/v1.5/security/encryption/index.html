<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title> - Hugo Whisper Theme</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="/favicon.png">

  
  
  <link rel="stylesheet" href="/css/style.min.aad43d4ecb69a264f2539b89d7f779d5f3cdff22e7585fe5fc3c77272f1c2696.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-docs">
      <a href="/docs/">
        <span>Docs</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="/"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-docs">
      <a href="/docs/">
        <span>Docs</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            



<div class="docs-menu">
  <div class="form-input-group mb-3 pr-3">
    <label>Version</label>
    <div class="custom_select">
      <select onchange="this.options[this.selectedIndex].value && (window.location = this.options[this.selectedIndex].value);">
        
          
            <option value="/docs/">docs</option>
          
        
          
            <option value="/v1.5/" selected>v1.5</option>
          
        
      </select>
    </div>
  </div>
  <ul class="toc">
    
    <h1 id="table-of-contents">Table of contents</h1>
<ul>
<li><a href="README.md">Introduction</a></li>
</ul>
<h2 id="prologue">Prologue</h2>
<ul>
<li><a href="prologue/introduction-and-installaton.md">Introduction and Installaton</a></li>
<li><a href="prologue/contributing-guide.md">Contributing Guide</a></li>
<li><a href="prologue/how-to-contribute.md">How To Contribute</a></li>
<li><a href="prologue/release-cycle.md">Release Cycle</a></li>
</ul>
<h2 id="whats-new">What&rsquo;s New</h2>
<ul>
<li><a href="whats-new/masonite-1.3.md">Masonite 1.3</a></li>
<li><a href="whats-new/masonite-1.4.md">Masonite 1.4</a></li>
<li><a href="whats-new/masonite-1.5.md">Masonite 1.5</a></li>
</ul>
<h2 id="upgrade-guide">Upgrade Guide</h2>
<ul>
<li><a href="upgrade-guide/masonite-1.3-to-1.4.md">Masonite 1.3 to 1.4</a></li>
<li><a href="upgrade-guide/masonite-1.4-to-1.5.md">Masonite 1.4 to 1.5</a></li>
</ul>
<h2 id="the-basics">The Basics</h2>
<ul>
<li><a href="the-basics/routing.md">Routing</a></li>
<li><a href="the-basics/controllers.md">Controllers</a></li>
<li><a href="the-basics/views.md">Views</a></li>
<li><a href="the-basics/requests.md">Requests</a></li>
<li><a href="the-basics/static-files.md">Static Files</a></li>
<li><a href="the-basics/helper-functions.md">Helper Functions</a></li>
</ul>
<h2 id="the-craft-command">The Craft Command</h2>
<ul>
<li><a href="the-craft-command/introduction.md">Introduction</a></li>
<li><a href="the-craft-command/creating-commands.md">Creating Commands</a></li>
<li><a href="the-craft-command/authentication-system.md">Authentication System</a></li>
</ul>
<h2 id="architectural-concepts">Architectural Concepts</h2>
<ul>
<li><a href="architectural-concepts/request-lifecycle.md">Request Lifecycle</a></li>
<li><a href="architectural-concepts/service-providers.md">Service Providers</a></li>
<li><a href="architectural-concepts/service-container.md">Service Container</a></li>
</ul>
<h2 id="advanced">Advanced</h2>
<ul>
<li><a href="advanced/middleware.md">Middleware</a></li>
<li><a href="advanced/validation.md">Validation</a></li>
<li><a href="advanced/creating-packages.md">Creating Packages</a></li>
<li><a href="advanced/extending-classes.md">Extending Classes</a></li>
<li><a href="advanced/creating-a-mail-driver.md">Creating a Mail Driver</a></li>
<li><a href="advanced/sessions.md">Sessions</a></li>
</ul>
<h2 id="useful-features">Useful Features</h2>
<ul>
<li><a href="useful-features/template-caching.md">Template Caching</a></li>
<li><a href="useful-features/mail.md">Mail</a></li>
<li><a href="useful-features/uploading.md">Uploading</a></li>
<li><a href="useful-features/view-composers-and-sharing.md">View Composers and Sharing</a></li>
<li><a href="useful-features/caching.md">Caching</a></li>
<li><a href="useful-features/broadcasting.md">Broadcasting</a></li>
<li><a href="useful-features/queues-and-jobs.md">Queues and Jobs</a></li>
<li><a href="useful-features/compiling-assets.md">Compiling Assets</a></li>
</ul>
<h2 id="security">Security</h2>
<ul>
<li><a href="security/authentication.md">Authentication</a></li>
<li><a href="security/encryption.md">Encryption</a></li>
<li><a href="security/csrf-protection.md">CSRF Protection</a></li>
</ul>
<h2 id="orator-orm">Orator ORM</h2>
<ul>
<li><a href="https://orator-orm.com/docs/0.9/basic_usage.html">Basic Usage</a></li>
<li><a href="https://orator-orm.com/docs/0.9/query_builder.html">Query Builder</a></li>
<li><a href="https://orator-orm.com/docs/0.9/orm.html">ORM</a></li>
<li><a href="https://orator-orm.com/docs/0.9/pagination.html">Pagination</a></li>
<li><a href="https://orator-orm.com/docs/0.9/schema_builder.html">Schema Builder</a></li>
<li><a href="orator-orm/database-migrations.md">Database Migrations</a></li>
<li><a href="https://orator-orm.com/docs/0.9/collections.html">Collections</a></li>
</ul>
<h2 id="managers-and-drivers">Managers and Drivers</h2>
<ul>
<li><a href="managers-and-drivers/about-managers.md">About Managers</a></li>
<li><a href="managers-and-drivers/about-drivers.md">About Drivers</a></li>
<li><a href="managers-and-drivers/contracts.md">Contracts</a></li>
</ul>
<h2 id="official-packages">Official Packages</h2>
<ul>
<li><a href="https://masoniteframework.gitbooks.io/masonite-entry/content/">Masonite Entry</a></li>
<li><a href="http://billing.masoniteproject.com">Masonite Billing</a></li>
</ul>
<h2 id="creating-your-first-blog">Creating Your First Blog</h2>
<ul>
<li><a href="creating-your-first-blog/introduction.md">Introduction</a></li>
<li><a href="creating-your-first-blog/part-1-creating-our-first-route.md">Part 1 - Creating Our First Route</a></li>
<li><a href="creating-your-first-blog/part-2-creating-our-first-controller.md">Part 2 - Creating Our First Controller</a></li>
<li><a href="creating-your-first-blog/part-3-designing-our-blog.md">Part 3 - Designing Our Blog</a></li>
<li><a href="creating-your-first-blog/part-4-migrations.md">Part 4 - Migrations</a></li>
<li><a href="creating-your-first-blog/part-5-models.md">Part 5 - Models</a></li>
<li><a href="creating-your-first-blog/part-3-authentication.md">Part 3 - Authentication</a></li>
</ul>
    
  </ul>
</div>


          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title"></h1>
<div class="content ">
  <h1 id="encryption">Encryption</h1>
<h2 id="introduction">Introduction</h2>
<p>Masonite comes with bcrypt out of the box but leaves it up to the developer to actually encrypt things like passwords. You can opt to use any other hashing library but bcrypt is the standard of a lot of libraries and comes with some one way hashing algorithms with no known vulnerabilities. Many of hashing algorithms like SHA-1 and MD5 are not secure and you should not use them in your application.</p>
<p>{% hint style=&quot;success&rdquo; %}
You can read the <div>
    <a href="bcrypt%20documentation%20here" target="_blank">bcrypt documentation here</a>
</div>.
{% endhint %}</p>
<h2 id="background">Background</h2>
<p>Also, we make sure that Javascript cannot read your cookies. It&rsquo;s important to know that although your website may be secure, you are susceptible to attacks if you import third party Javascript packages (since those libraries could be hackable) which can read all cookies on your website and send them to the hacker.</p>
<p>Other frameworks use cryptographic signing which attached a special key to your cookies that prevents manipulation. This does&rsquo;t make sense as a major part of XSS protection is preventing third parties from reading cookies. It doesn&rsquo;t make sense to attach a digital signature to a plaintext cookie if you don&rsquo;t want third parties to see the cookie (such as a session id). Masonite takes one step further and encrypts the entire string and can only be decrypted using your secret key (so make sure you keep it secret).</p>
<h2 id="secret-key">Secret Key</h2>
<p>In your <code>.env</code> file, you will find a setting called <code>KEY=your-secret-key</code>. This is the SALT that is used to encrypt and decrypt your cookies. It is important to change this key sometime before development. You can generate new secret keys by running:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ craft key
</code></pre></div><p>This will generate a new key in your terminal which you can copy and paste into your <code>.env</code> file. Your <code>config/application.py</code> file uses this environment variable to set the <code>KEY</code> configuration setting.</p>
<p>Additionally you can pass the <code>--store</code> flag which will automatically set the <code>KEY=</code> value in your <code>.env</code> file for you:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ craft key --store
</code></pre></div><p>{% hint style=&quot;danger&rdquo; %}
Remember to not share this secret key as a loss of this key could lead to someone being able to decrypt any cookies set by your application. If you find that your secret key is compromised, just generate a new key.
{% endhint %}</p>
<h2 id="cryptographic-signing">Cryptographic Signing</h2>
<p>You can use the same cryptographic signing that Masonite uses to encrypt cookies on any data you want. Just import the <code>masonite.sign.Sign</code> class. A complete signing will look something like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">masonite.auth.Sign</span> <span class="kn">import</span> <span class="n">Sign</span>

<span class="n">sign</span> <span class="o">=</span> <span class="n">Sign</span><span class="p">()</span>

<span class="n">sign</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="c1"># PSJDUudbs87SB....</span>

<span class="n">sign</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="c1"># &#39;value&#39;</span>
</code></pre></div><p>By default, <code>Sign()</code> uses the encryption key in your <code>config/application.py</code> file but you could also pass in your own key.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">masonite.auth.Sign</span> <span class="kn">import</span> <span class="n">Sign</span>

<span class="n">encryption_key</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;SJS(839dhs...&#39;</span>

<span class="n">sign</span> <span class="o">=</span> <span class="n">Sign</span><span class="p">(</span><span class="n">encryption_key</span><span class="p">)</span>

<span class="n">sign</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="c1"># PSJDUudbs87SB....</span>

<span class="n">sign</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="c1"># &#39;value&#39;</span>
</code></pre></div><p>This feature uses <div>
    <a href="pyca/cryptography" target="_blank">pyca/cryptography</a>
</div> for this kind of encryption. Because of this, we can generate keys using Fernet.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">masonite.auth.Sign</span> <span class="kn">import</span> <span class="n">Sign</span>
<span class="kn">from</span> <span class="nn">cryptography.fernet</span> <span class="kn">import</span> <span class="n">Fernet</span>

<span class="n">encryption_key</span> <span class="o">=</span> <span class="n">Fernet</span><span class="o">.</span><span class="n">generate_key</span><span class="p">()</span>

<span class="n">sign</span> <span class="o">=</span> <span class="n">Sign</span><span class="p">(</span><span class="n">encryption_key</span><span class="p">)</span>

<span class="n">sign</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="c1"># PSJDUudbs87SB....</span>

<span class="n">sign</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="c1"># &#39;value&#39;</span>
</code></pre></div><p>Just remember to store the key you generated or you will not be able to decrypt any values that you encrypted.</p>
<h2 id="using-bcrypt">Using bcrypt</h2>
<p>Bcrypt is very easy to use an basically consists of a 1 way hash, and then a check to verify if that 1 way hash matches an input given to it.</p>
<p>{% hint style=&quot;warning&rdquo; %}
It&rsquo;s important to note that any values passed to bcrypt need to be in bytes.
{% endhint %}</p>
<h3 id="hashing-passwords">Hashing Passwords</h3>
<p>Again, all values passed into bcrypt need to be in bytes so we can pass in a password:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">password</span> <span class="o">=</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">hashpw</span><span class="p">(</span>
                <span class="nb">bytes</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">),</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="n">bcrypt</span><span class="o">.</span><span class="n">gensalt</span><span class="p">()</span>
            <span class="p">)</span>
</code></pre></div><p>Notice that the value passed in from the request was converted into bytes using the <code>bytes()</code> Python function.</p>
<p>Once the password is hashed, we can just safely store it into our database</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">User</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span>
    <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
    <span class="n">email</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div><p>{% hint style=&quot;danger&rdquo; %}
Do not store unhashed passwords in your database. Also, do not use unsafe encryption methods like MD5 or SHA-1.
{% endhint %}</p>
<h3 id="checking-hashed-passwords">Checking Hashed Passwords</h3>
<p>In order to check if a password matches it&rsquo;s hashed form, such as trying to login a user, we can use the <code>bcrypt.checkpw()</code> function:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">bcrypt</span><span class="o">.</span><span class="n">checkpw</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">),</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</code></pre></div><p>This will return true if the string <code>'password'</code> is equal to the models password.</p>
<p>More information on bcrypt can be found by reading it&rsquo;s documentation.</p>

</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
