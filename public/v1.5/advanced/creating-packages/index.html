<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title> - Hugo Whisper Theme</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="/favicon.png">

  
  
  <link rel="stylesheet" href="/css/style.min.aad43d4ecb69a264f2539b89d7f779d5f3cdff22e7585fe5fc3c77272f1c2696.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-docs">
      <a href="/docs/">
        <span>Docs</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="/"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-docs">
      <a href="/docs/">
        <span>Docs</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            



<div class="docs-menu">
  <div class="form-input-group mb-3 pr-3">
    <label>Version</label>
    <div class="custom_select">
      <select onchange="this.options[this.selectedIndex].value && (window.location = this.options[this.selectedIndex].value);">
        
          
            <option value="/docs/">docs</option>
          
        
          
            <option value="/v1.5/" selected>v1.5</option>
          
        
      </select>
    </div>
  </div>
  <ul class="toc">
    
    <h1 id="table-of-contents">Table of contents</h1>
<ul>
<li><a href="README.md">Introduction</a></li>
</ul>
<h2 id="prologue">Prologue</h2>
<ul>
<li><a href="prologue/introduction-and-installaton.md">Introduction and Installaton</a></li>
<li><a href="prologue/contributing-guide.md">Contributing Guide</a></li>
<li><a href="prologue/how-to-contribute.md">How To Contribute</a></li>
<li><a href="prologue/release-cycle.md">Release Cycle</a></li>
</ul>
<h2 id="whats-new">What&rsquo;s New</h2>
<ul>
<li><a href="whats-new/masonite-1.3.md">Masonite 1.3</a></li>
<li><a href="whats-new/masonite-1.4.md">Masonite 1.4</a></li>
<li><a href="whats-new/masonite-1.5.md">Masonite 1.5</a></li>
</ul>
<h2 id="upgrade-guide">Upgrade Guide</h2>
<ul>
<li><a href="upgrade-guide/masonite-1.3-to-1.4.md">Masonite 1.3 to 1.4</a></li>
<li><a href="upgrade-guide/masonite-1.4-to-1.5.md">Masonite 1.4 to 1.5</a></li>
</ul>
<h2 id="the-basics">The Basics</h2>
<ul>
<li><a href="the-basics/routing.md">Routing</a></li>
<li><a href="the-basics/controllers.md">Controllers</a></li>
<li><a href="the-basics/views.md">Views</a></li>
<li><a href="the-basics/requests.md">Requests</a></li>
<li><a href="the-basics/static-files.md">Static Files</a></li>
<li><a href="the-basics/helper-functions.md">Helper Functions</a></li>
</ul>
<h2 id="the-craft-command">The Craft Command</h2>
<ul>
<li><a href="the-craft-command/introduction.md">Introduction</a></li>
<li><a href="the-craft-command/creating-commands.md">Creating Commands</a></li>
<li><a href="the-craft-command/authentication-system.md">Authentication System</a></li>
</ul>
<h2 id="architectural-concepts">Architectural Concepts</h2>
<ul>
<li><a href="architectural-concepts/request-lifecycle.md">Request Lifecycle</a></li>
<li><a href="architectural-concepts/service-providers.md">Service Providers</a></li>
<li><a href="architectural-concepts/service-container.md">Service Container</a></li>
</ul>
<h2 id="advanced">Advanced</h2>
<ul>
<li><a href="advanced/middleware.md">Middleware</a></li>
<li><a href="advanced/validation.md">Validation</a></li>
<li><a href="advanced/creating-packages.md">Creating Packages</a></li>
<li><a href="advanced/extending-classes.md">Extending Classes</a></li>
<li><a href="advanced/creating-a-mail-driver.md">Creating a Mail Driver</a></li>
<li><a href="advanced/sessions.md">Sessions</a></li>
</ul>
<h2 id="useful-features">Useful Features</h2>
<ul>
<li><a href="useful-features/template-caching.md">Template Caching</a></li>
<li><a href="useful-features/mail.md">Mail</a></li>
<li><a href="useful-features/uploading.md">Uploading</a></li>
<li><a href="useful-features/view-composers-and-sharing.md">View Composers and Sharing</a></li>
<li><a href="useful-features/caching.md">Caching</a></li>
<li><a href="useful-features/broadcasting.md">Broadcasting</a></li>
<li><a href="useful-features/queues-and-jobs.md">Queues and Jobs</a></li>
<li><a href="useful-features/compiling-assets.md">Compiling Assets</a></li>
</ul>
<h2 id="security">Security</h2>
<ul>
<li><a href="security/authentication.md">Authentication</a></li>
<li><a href="security/encryption.md">Encryption</a></li>
<li><a href="security/csrf-protection.md">CSRF Protection</a></li>
</ul>
<h2 id="orator-orm">Orator ORM</h2>
<ul>
<li><a href="https://orator-orm.com/docs/0.9/basic_usage.html">Basic Usage</a></li>
<li><a href="https://orator-orm.com/docs/0.9/query_builder.html">Query Builder</a></li>
<li><a href="https://orator-orm.com/docs/0.9/orm.html">ORM</a></li>
<li><a href="https://orator-orm.com/docs/0.9/pagination.html">Pagination</a></li>
<li><a href="https://orator-orm.com/docs/0.9/schema_builder.html">Schema Builder</a></li>
<li><a href="orator-orm/database-migrations.md">Database Migrations</a></li>
<li><a href="https://orator-orm.com/docs/0.9/collections.html">Collections</a></li>
</ul>
<h2 id="managers-and-drivers">Managers and Drivers</h2>
<ul>
<li><a href="managers-and-drivers/about-managers.md">About Managers</a></li>
<li><a href="managers-and-drivers/about-drivers.md">About Drivers</a></li>
<li><a href="managers-and-drivers/contracts.md">Contracts</a></li>
</ul>
<h2 id="official-packages">Official Packages</h2>
<ul>
<li><a href="https://masoniteframework.gitbooks.io/masonite-entry/content/">Masonite Entry</a></li>
<li><a href="http://billing.masoniteproject.com">Masonite Billing</a></li>
</ul>
<h2 id="creating-your-first-blog">Creating Your First Blog</h2>
<ul>
<li><a href="creating-your-first-blog/introduction.md">Introduction</a></li>
<li><a href="creating-your-first-blog/part-1-creating-our-first-route.md">Part 1 - Creating Our First Route</a></li>
<li><a href="creating-your-first-blog/part-2-creating-our-first-controller.md">Part 2 - Creating Our First Controller</a></li>
<li><a href="creating-your-first-blog/part-3-designing-our-blog.md">Part 3 - Designing Our Blog</a></li>
<li><a href="creating-your-first-blog/part-4-migrations.md">Part 4 - Migrations</a></li>
<li><a href="creating-your-first-blog/part-5-models.md">Part 5 - Models</a></li>
<li><a href="creating-your-first-blog/part-3-authentication.md">Part 3 - Authentication</a></li>
</ul>
    
  </ul>
</div>


          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title"></h1>
<div class="content ">
  <h1 id="creating-packages">Creating Packages</h1>
<h2 id="introduction">Introduction</h2>
<p>Creating packages is very simple for Masonite. You can get a package created and on PyPi is less than 5 minutes. With Masonite packages you&rsquo;ll easily be able to integrate and scaffold all Masonite projects with ease. Masonite comes with several helper functions in order to create packages which can add configuration files, routes, controllers, views, commands and more.</p>
<h2 id="getting-started">Getting Started</h2>
<p>As a developer, you will be responsible for both making packages and consuming packages. In this documentation we&rsquo;ll talk about both. We&rsquo;ll start by talking about how to make a package and then talk about how to use that package or other third party packages.</p>
<p>Masonite, being a Python framework, can obviously utilize all Python packages that aren’t designed for a specific framework. For example, Masonite can obviously use a library like requests but can’t use Django Rest Framework.</p>
<p>Similarly to how Django Rest Framework was built for Django, you can also build packages specific to Masonite. Although you can just as simply build packages for both, as long as you add some sort of Service Provider to your package that can integrate your library into Masonite.</p>
<h3 id="about-packages">About Packages</h3>
<p>There are several key functions that Masonite uses in order to create applications. These include primarily: routes, controllers, views, and craft commands. Creating a package is simple. Conveniently Masonite comes with several helper functions in order to create all of these.</p>
<p>You can easily create a command like <code>craft mypackage:install</code> and can scaffold out and install controllers, routes, etc into a Masonite project.</p>
<p>You do not have to use this functionality and instead have the developer copy and paste things that they need to from your documentation but having a great setup process is a great way to promote developer happiness which is what Masonite is all about.</p>
<h3 id="creating-a-package">Creating a Package</h3>
<p>Like other parts of Masonite, in order to make a package, we can use a craft command. The <code>craft package</code> command will scaffold out a simple PyPi package and is fully able to be uploaded directly to PyPi.</p>
<p>This should be done in a separate folder outside of your project.</p>
<p>Let&rsquo;s create our package:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ craft package testpackage
</code></pre></div><p>This will create a file structure like:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">testpackage/
    __init__.py
    integration.py
MANIFEST.in
setup.py
</code></pre></div><h3 id="creating-a-config-package"><strong>Creating a Config Package</strong></h3>
<p>Lets create a simple package that will add or append a config file from our package and into the project.</p>
<p>First lets create a config file inside <code>testpackage/snippets/configs/services.py</code>. We should now have a project structure like:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">testpackage/
    __init__.py
    integration.py
    snippets/
        configs/
            services.py
MANIFEST.in
setup.py
</code></pre></div><p>Great! inside the <code>services.py</code> lets put a configuration setting. This configuration file will be directly added into a Masonite project so you can put doctrings or flagpole comments directly in here:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">TESTPACKAGE_PAYMENTS = {
    &#39;stripe&#39;: {
        &#39;some key&#39;: &#39;some value&#39;,
        &#39;another key&#39;: &#39;another value&#39;
    }
}
</code></pre></div><p>Perfect! Now we&rsquo;ll just need to tell PyPi to include this file when we upload it to PyPi. We can do this in our <code>MANIFEST.in</code> file.</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">include testpackage/snippets/configs/*
</code></pre></div><h3 id="creating-an-install-command"><strong>Creating an Install Command</strong></h3>
<p>It&rsquo;s great (and convenient) to add craft commands to a project so developers can use your package more efficiently. You can head over the <div>
    <a href="Creating%20Commands">Creating Commands</a>
</div> to learn how to create a command. It only involves a normal command class and a Service Provider.</p>
<p>Head over to that documentation page and create an <code>InstallCommand</code> and an <code>InstallProvider</code>. This step should take less than a few minutes. Once those are created we can continue to the adding package helpers below.</p>
<h3 id="adding-migration-directories"><strong>Adding Migration Directories</strong></h3>
<p>Masonite packages allow you to add new migrations to a project. For example, this could be used to add a new <code>package_subscriptions</code> table if you are building a package that works for subscribing users to Stripe.</p>
<p>Inside the Service Provider you plan to use for your package we can register our directory:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">masonite.provider</span> <span class="kn">import</span> <span class="n">ServiceProvider</span>

<span class="n">package_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">ApiProvider</span><span class="p">(</span><span class="n">ServiceProvider</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span>
            <span class="s1">&#39;TestPackageMigrationDirectory&#39;</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">package_directory</span><span class="p">,</span> <span class="s1">&#39;../migrations&#39;</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div><p>Masonite will find any keys in the container that end with <code>MigrationDirectory</code> and will add it to the list of migrations being ran whenever <code>craft migrate</code> and <code>craft migrate:*</code> commands are ran.</p>
<p>The <code>package_directory</code> variable contains the absolute path to the current file so the migration directory being added should also be an absolute path to the migration directory as demonstrated here. Notice the <code>../migrations</code> syntax. This is going back one directory and into a migration directory there.</p>
<h3 id="package-helpers"><strong>Package Helpers</strong></h3>
<p>Almost done. Now we just need to put our <code>masonite.package</code> helper functions in our install command. The location we put in our <code>create_or_append_config()</code> function should be an absolute path location to our package. To help with this, Masonite has put a variable called <code>package_directory</code> inside the <code>integration.py</code> file. Our handle method inside our install command should look something like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">cleo</span> <span class="kn">import</span> <span class="n">Command</span>
<span class="kn">from</span> <span class="nn">masonite.packages</span> <span class="kn">import</span> <span class="n">create_or_append_config</span>


<span class="n">package_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">InstallCommand</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
    <span class="s2">&#34;&#34;&#34;
</span><span class="s2">    Installs needed configuration files into a Masonite project
</span><span class="s2">
</span><span class="s2">    testpackage:install
</span><span class="s2">    &#34;&#34;&#34;</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">create_or_append_config</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">package_directory</span><span class="p">,</span>
                <span class="s1">&#39;../testpackage/snippets/configs/services.py&#39;</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div><p>{% hint style=&quot;warning&rdquo; %}
<strong>Make sure this command is added to your Service Provider and the developer using your package adds it to the</strong> <code>PROVIDERS</code> <strong>list as per the</strong> <div>
    <a href="%3cstrong%3eCreating%20Commands%3c/strong%3e"><strong>Creating Commands</strong></a>
</div> <strong>documentation.</strong>
{% endhint %}</p>
<p>This will append the configuration file that has the same name as our package configuration file. In this case the configuration file we are creating or appending to is <code>config/services.py</code> because our packages configuration file is <code>services.py</code>. If we want to append to another configuration file we can simply change the name of our package configuration file.</p>
<h3 id="working-with-our-package"><strong>Working With Our Package</strong></h3>
<p>We can either test our package locally or upload our package to PyPi.</p>
<p>To test our package locally, if you use virtual environments, just go to your Masonite project and activate your virtual environment. Navigate to the folder where you created your package and run:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ pip install .
</code></pre></div><p>If you want to be able to make changes without having to constantly reinstall your package then run</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ pip install --editable .
</code></pre></div><p>This will install your new package into your virtual environment. Go back to your project root so we can run our <code>craft testpackage:install</code> command. If we run that we should have a new configuration file under <code>config/services.py</code>.</p>
<h3 id="uploading-to-pypi"><strong>Uploading to PyPi</strong></h3>
<p>If you have never set up a package before then you&rsquo;ll need to <div>
    <a href="check%20how%20to%20make%20a%20%3ccode%3e.pypirc%3c/code%3e%20file" target="_blank">check how to make a <code>.pypirc</code> file</a>
</div>. This file will hold our PyPi credentials.</p>
<p>To upload to PyPi we just have to pick a great name for our package in the <code>setup.py</code> file. Now that you have a super awesome name, we&rsquo;ll just need to run:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ python setup.py sdist upload
</code></pre></div><p>which should upload our package with our credentials in our <code>.pypirc</code> file. Make sure you click the link above and see how to make once.</p>
<p>If <code>python</code> doesn’t default to Python 3 or if PyPi throws errors than you may need to run:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ python3 setup.py sdist upload
</code></pre></div><h3 id="consuming-a-package"><strong>Consuming a package.</strong></h3>
<p>Now that your package is on PyPi we can just run:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ pip install super_awesome_package
</code></pre></div><p>Then add your Service Provider to the <code>PROVIDERS</code> list:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">PROVIDERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">...</span>
    <span class="c1"># New Provider</span>
    <span class="s1">&#39;testpackage.providers.InstallProvider.InstallProvider&#39;</span><span class="p">,</span>
<span class="p">]</span>
</code></pre></div><p>and then run:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">$ craft testpackage:install
</code></pre></div><p>Remember our Service Provider added the command automatically to craft.</p>
<p>Again, not all packages will need to be installed or even need commands. Only packages that need to scaffold the project or something similar need one. This should be a judgment call on the package author instead of a requirement.</p>
<p>You will know if a package needs to be installed by reading the packages install documentation that is written by the package authors.</p>
<h2 id="helper-functions">Helper Functions</h2>
<p>These helper functions are used inside the install commands or anywhere else in your package where you need to scaffold a Masonite project.</p>
<p>The <code>location</code> specified as parameters here are absolute path locations. You can achieve this by using the <code>package_directory</code> variable in your <code>integration.py</code> file.</p>
<p>To achieve an absolute path location, this will look like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">package_directory</span><span class="p">,</span> <span class="s1">&#39;snippets/configs/services.py&#39;</span>
        <span class="p">)</span>
</code></pre></div><p>All helper functions are located in the <code>masonite.packages</code> module. To use these functions you’ll need to import the function to be used like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">masonite.packages</span> <span class="kn">import</span> <span class="n">create_or_append_config</span>
</code></pre></div><h3 id="creating-configuration-files"><strong>Creating Configuration Files</strong></h3>
<p><code>create_or_append_config(location)</code> will create a configuration file based on a configuration file from your package.</p>
<h3 id="creating-web-routes"><strong>Creating Web Routes</strong></h3>
<p><code>append_web_routes(location)</code> will append web routes to the <code>routes/web.py</code> file. Your web routes should have a <code>+=</code> to the <code>ROUTES</code> constant and should look something like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">ROUTES</span> <span class="o">+=</span> <span class="p">[</span>
    <span class="c1"># your package routes here</span>
<span class="p">]</span>
</code></pre></div><h3 id="creating-api-routes"><strong>Creating Api Routes</strong></h3>
<p><code>append_api_routes(location)</code> will append api routes to a masonite project under <code>routes/api.py</code>. Your api routes should have a <code>+=</code> to the <code>ROUTES</code> constant and should look something like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">ROUTES</span> <span class="o">+=</span> <span class="p">[</span>
    <span class="c1"># your package routes here</span>
<span class="p">]</span>
</code></pre></div><h3 id="creating-controllers"><strong>Creating Controllers</strong></h3>
<p><code>create_controller(location)</code> will take a controller from your package and append it under the <code>app.http.controllers</code> namespace by default.</p>
<p>You can also optionally add a <code>to</code> parameter to specify which directory you want to install the controller into. The directory will automatically be created.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">create_controller</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">package_directory</span><span class="p">,</span> <span class="s1">&#39;snippets/controller/ControllerHere.py&#39;</span>
    <span class="p">),</span>
    <span class="n">to</span> <span class="o">=</span> <span class="s1">&#39;app/http/controllers/Vendor/Package&#39;</span>
<span class="p">)</span>
</code></pre></div><p>This will create the controller in <code>app.http.controller.Vendor.Package.ControllerHere.py</code></p>

</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
