<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title> - Hugo Whisper Theme</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="/favicon.png">

  
  
  <link rel="stylesheet" href="/css/style.min.aad43d4ecb69a264f2539b89d7f779d5f3cdff22e7585fe5fc3c77272f1c2696.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-docs">
      <a href="/docs/">
        <span>Docs</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="/"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-docs">
      <a href="/docs/">
        <span>Docs</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            



<div class="docs-menu">
  <div class="form-input-group mb-3 pr-3">
    <label>Version</label>
    <div class="custom_select">
      <select onchange="this.options[this.selectedIndex].value && (window.location = this.options[this.selectedIndex].value);">
        
          
            <option value="/docs/">docs</option>
          
        
          
            <option value="/v1.5/" selected>v1.5</option>
          
        
      </select>
    </div>
  </div>
  <ul class="toc">
    
    <h1 id="table-of-contents">Table of contents</h1>
<ul>
<li><a href="README.md">Introduction</a></li>
</ul>
<h2 id="prologue">Prologue</h2>
<ul>
<li><a href="prologue/introduction-and-installaton.md">Introduction and Installaton</a></li>
<li><a href="prologue/contributing-guide.md">Contributing Guide</a></li>
<li><a href="prologue/how-to-contribute.md">How To Contribute</a></li>
<li><a href="prologue/release-cycle.md">Release Cycle</a></li>
</ul>
<h2 id="whats-new">What&rsquo;s New</h2>
<ul>
<li><a href="whats-new/masonite-1.3.md">Masonite 1.3</a></li>
<li><a href="whats-new/masonite-1.4.md">Masonite 1.4</a></li>
<li><a href="whats-new/masonite-1.5.md">Masonite 1.5</a></li>
</ul>
<h2 id="upgrade-guide">Upgrade Guide</h2>
<ul>
<li><a href="upgrade-guide/masonite-1.3-to-1.4.md">Masonite 1.3 to 1.4</a></li>
<li><a href="upgrade-guide/masonite-1.4-to-1.5.md">Masonite 1.4 to 1.5</a></li>
</ul>
<h2 id="the-basics">The Basics</h2>
<ul>
<li><a href="the-basics/routing.md">Routing</a></li>
<li><a href="the-basics/controllers.md">Controllers</a></li>
<li><a href="the-basics/views.md">Views</a></li>
<li><a href="the-basics/requests.md">Requests</a></li>
<li><a href="the-basics/static-files.md">Static Files</a></li>
<li><a href="the-basics/helper-functions.md">Helper Functions</a></li>
</ul>
<h2 id="the-craft-command">The Craft Command</h2>
<ul>
<li><a href="the-craft-command/introduction.md">Introduction</a></li>
<li><a href="the-craft-command/creating-commands.md">Creating Commands</a></li>
<li><a href="the-craft-command/authentication-system.md">Authentication System</a></li>
</ul>
<h2 id="architectural-concepts">Architectural Concepts</h2>
<ul>
<li><a href="architectural-concepts/request-lifecycle.md">Request Lifecycle</a></li>
<li><a href="architectural-concepts/service-providers.md">Service Providers</a></li>
<li><a href="architectural-concepts/service-container.md">Service Container</a></li>
</ul>
<h2 id="advanced">Advanced</h2>
<ul>
<li><a href="advanced/middleware.md">Middleware</a></li>
<li><a href="advanced/validation.md">Validation</a></li>
<li><a href="advanced/creating-packages.md">Creating Packages</a></li>
<li><a href="advanced/extending-classes.md">Extending Classes</a></li>
<li><a href="advanced/creating-a-mail-driver.md">Creating a Mail Driver</a></li>
<li><a href="advanced/sessions.md">Sessions</a></li>
</ul>
<h2 id="useful-features">Useful Features</h2>
<ul>
<li><a href="useful-features/template-caching.md">Template Caching</a></li>
<li><a href="useful-features/mail.md">Mail</a></li>
<li><a href="useful-features/uploading.md">Uploading</a></li>
<li><a href="useful-features/view-composers-and-sharing.md">View Composers and Sharing</a></li>
<li><a href="useful-features/caching.md">Caching</a></li>
<li><a href="useful-features/broadcasting.md">Broadcasting</a></li>
<li><a href="useful-features/queues-and-jobs.md">Queues and Jobs</a></li>
<li><a href="useful-features/compiling-assets.md">Compiling Assets</a></li>
</ul>
<h2 id="security">Security</h2>
<ul>
<li><a href="security/authentication.md">Authentication</a></li>
<li><a href="security/encryption.md">Encryption</a></li>
<li><a href="security/csrf-protection.md">CSRF Protection</a></li>
</ul>
<h2 id="orator-orm">Orator ORM</h2>
<ul>
<li><a href="https://orator-orm.com/docs/0.9/basic_usage.html">Basic Usage</a></li>
<li><a href="https://orator-orm.com/docs/0.9/query_builder.html">Query Builder</a></li>
<li><a href="https://orator-orm.com/docs/0.9/orm.html">ORM</a></li>
<li><a href="https://orator-orm.com/docs/0.9/pagination.html">Pagination</a></li>
<li><a href="https://orator-orm.com/docs/0.9/schema_builder.html">Schema Builder</a></li>
<li><a href="orator-orm/database-migrations.md">Database Migrations</a></li>
<li><a href="https://orator-orm.com/docs/0.9/collections.html">Collections</a></li>
</ul>
<h2 id="managers-and-drivers">Managers and Drivers</h2>
<ul>
<li><a href="managers-and-drivers/about-managers.md">About Managers</a></li>
<li><a href="managers-and-drivers/about-drivers.md">About Drivers</a></li>
<li><a href="managers-and-drivers/contracts.md">Contracts</a></li>
</ul>
<h2 id="official-packages">Official Packages</h2>
<ul>
<li><a href="https://masoniteframework.gitbooks.io/masonite-entry/content/">Masonite Entry</a></li>
<li><a href="http://billing.masoniteproject.com">Masonite Billing</a></li>
</ul>
<h2 id="creating-your-first-blog">Creating Your First Blog</h2>
<ul>
<li><a href="creating-your-first-blog/introduction.md">Introduction</a></li>
<li><a href="creating-your-first-blog/part-1-creating-our-first-route.md">Part 1 - Creating Our First Route</a></li>
<li><a href="creating-your-first-blog/part-2-creating-our-first-controller.md">Part 2 - Creating Our First Controller</a></li>
<li><a href="creating-your-first-blog/part-3-designing-our-blog.md">Part 3 - Designing Our Blog</a></li>
<li><a href="creating-your-first-blog/part-4-migrations.md">Part 4 - Migrations</a></li>
<li><a href="creating-your-first-blog/part-5-models.md">Part 5 - Models</a></li>
<li><a href="creating-your-first-blog/part-3-authentication.md">Part 3 - Authentication</a></li>
</ul>
    
  </ul>
</div>


          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title"></h1>
<div class="content ">
  <h1 id="sessions">Sessions</h1>
<h2 id="introduction">Introduction</h2>
<p>You&rsquo;ll find yourself needing to add temporary data to an individual user. Sessions allow you to do this by adding a key value pair and attaching it to the user&rsquo;s IP address. You can reset the session data anytime you want; which is usually done on logout or login actions.</p>
<p>The Session features are added to the framework through the <code>SessionProvider</code> Service Provider. This provider needs to be between the <code>AppProvider</code> and the <code>RouteProvider</code>. For Masonite 1.5+, this provider is already available for you.</p>
<p>It&rsquo;s important to note that the Session will default to the <code>memory</code> driver. This means that all session data is stored in an instantiated object when the server starts and is destroyed when the server stops. This is not good when using a WSGI server like Gunicorn which might use multiple workers because each worker will create it&rsquo;s own memory state and requests may jump from worker to worker unpredictably. If you are only using 1 worker then this won&rsquo;t be an issue as long as the worker doesn&rsquo;t die and reset for the duration of the server&rsquo;s life. In this case you should use another driver that doesn&rsquo;t have the memory issue like the <code>cookie</code> driver which will store all session information as cookies instead of in memory.</p>
<h2 id="getting-started">Getting Started</h2>
<p>There are a two ideas behind sessions. There is <strong>session data</strong> and <strong>flash data</strong>. Session data is any data that is persistent for the duration of the session and flash data is data that is only persisted on the next request. Flash data is useful for showing things like success or warning messages after a redirection.</p>
<p>Session data is automatically encrypted and decrypted using your secret key when using the <code>cookie</code> driver.</p>
<h2 id="using-sessions">Using Sessions</h2>
<p>Sessions are loaded into the container with the <code>Session</code> key. So you may access the <code>Session</code> class in any part of code that is resolved by the container. These include controllers, drivers, middleware etc:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Session</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">Session</span><span class="p">)</span> <span class="c1"># Session class</span>
</code></pre></div><h3 id="setting-data">Setting Data</h3>
<p>Data can easily be persisted to the current user by using the <code>set</code> method. If you are using the <code>memory</code> driver, it will connect the current user&rsquo;s IP address to the data. If you are using the <code>cookie</code> then it will simply set a cookie with a <code>s_</code> prefix to notify that it is a session and allows better handling of session cookies compared to other cookies.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Session</span><span class="p">):</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
</code></pre></div><p>This will update a dictionary that is linked to the current user.</p>
<h3 id="getting-data">Getting Data</h3>
<p>Data can be pulled from the session:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Session</span><span class="p">):</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span> <span class="c1"># Returns &#39;value&#39;</span>
</code></pre></div><h3 id="checking-data">Checking Data</h3>
<p>Very often, you will want to see if a value exists in the session:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Session</span><span class="p">):</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span> <span class="c1"># Returns True</span>
</code></pre></div><h3 id="getting-all-data">Getting all Data</h3>
<p>You can get all data for the current user:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Session</span><span class="p">):</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="c1"># Returns {&#39;key&#39;: &#39;value&#39;}</span>
</code></pre></div><h3 id="flashing-data">Flashing Data</h3>
<p>Data can be inserted only for the next request. This is useful when using redirection and displaying a success message.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Session</span><span class="p">):</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">flash</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;Your action is successful&#39;</span><span class="p">)</span>
</code></pre></div><p>When using the <code>cookie</code> driver, the cookie will automatically be deleted after 2 seconds of being set.</p>
<h3 id="changing-drivers">Changing Drivers</h3>
<p>You can of course change the drivers on the fly by using the <code>SessionManager</code> key from the container:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">SessionManager</span><span class="p">):</span>
    <span class="n">SessionManager</span><span class="o">.</span><span class="n">driver</span><span class="p">(</span><span class="s1">&#39;cookie&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
</code></pre></div><p>It&rsquo;s important to note that changing the drivers will not change the <code>session()</code> function inside your templates (more about templates below).</p>
<h3 id="request-class">Request Class</h3>
<p>The <code>SessionProvider</code> attaches a <code>session</code> attribute to the <code>Request</code> class. This attribute is the <code>Session</code> class itself.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">request</span><span class="p">()</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">flash</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;Your action is successful&#39;</span><span class="p">)</span>
</code></pre></div><h3 id="templates">Templates</h3>
<p>The <code>SessionProvider</code> comes with a helper method that is automatically injected into all templates. You can use the session helper just like you would use the <code>Session</code> class.</p>
<p>This helper method will only point to the default driver set inside <code>config/session.py</code> file. It will not point to the correct driver when it is changed using the <code>SessionManager</code> class. If you need to use other drivers, consider passing in a new function method through your view or changing the driver value inside <code>config/session.py</code></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">session</span><span class="p">()</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">)</span> <span class="o">%</span><span class="p">}</span>
    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;alert alert-success&#34;</span><span class="o">&gt;</span>
        <span class="p">{{</span> <span class="n">session</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">)</span> <span class="p">}}</span>
    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</code></pre></div><p>You could use this to create a simple Jinja include template that can show success, warning or error messages. Your template could be located inside a <code>resources/templates/helpers/messages.html</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">session</span><span class="p">()</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">)</span> <span class="o">%</span><span class="p">}</span>

    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;alert alert-success&#34;</span><span class="o">&gt;</span>
        <span class="p">{{</span> <span class="n">session</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">)</span> <span class="p">}}</span>
    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

<span class="p">{</span><span class="o">%</span> <span class="k">elif</span> <span class="n">session</span><span class="p">()</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="s1">&#39;warning&#39;</span><span class="p">)</span> <span class="o">%</span><span class="p">}</span>

    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;alert alert-warning&#34;</span><span class="o">&gt;</span>
        <span class="p">{{</span> <span class="n">session</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;warning&#39;</span><span class="p">)</span> <span class="p">}}</span>
    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">session</span><span class="p">()</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="s1">&#39;danger&#39;</span><span class="p">)</span> <span class="o">%</span><span class="p">}</span>

    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&#34;alert alert-danger&#34;</span><span class="o">&gt;</span>
        <span class="p">{{</span> <span class="n">session</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;danger&#39;</span><span class="p">)</span> <span class="p">}}</span>
    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>

<span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</code></pre></div><p>Then inside your working template you could add:</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">{% include &#39;helpers/messages.html&#39; %}
</code></pre></div><p>Then inside your controller you could do something like:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">request</span><span class="p">()</span><span class="o">.</span><span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/dashboard&#39;</span><span class="p">)</span> \
        <span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">flash</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;Action Successful!&#39;</span><span class="p">)</span>
</code></pre></div><p>or as separate statements</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Session</span><span class="p">):</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">flash</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;Action Successful!&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">request</span><span class="p">()</span><span class="o">.</span><span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/dashboard&#39;</span><span class="p">)</span>
</code></pre></div><p>Which will show the correct message and message type.</p>
<h3 id="resetting-data">Resetting Data</h3>
<p>You can reset both the flash data and the session data through the <code>reset</code> method.</p>
<p>To reset just the session data:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Session</span><span class="p">):</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</code></pre></div><p>Or to reset only the flash data:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Session</span><span class="p">):</span>
    <span class="n">Session</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">flash_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div><p>{% hint style=&quot;warning&rdquo; %}
Remember that Masonite will reset flashed data at the end of a successful <code>200 OK</code> request anyway so you will most likely not use the <code>flash_only=True</code> keyword parameter.
{% endhint %}</p>

</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.1237ff71925bb8625c97a9af8db4c54525258bedfd7c47493daaff723bea755e.js"></script>
  

  
  
  
    
  


</body>

</html>
